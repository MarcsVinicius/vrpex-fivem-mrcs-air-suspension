<!DOCTYPE html>
<head>
  <script
  src="https://code.jquery.com/jquery-3.6.1.min.js"
  integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ="
  crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <style>
        body {
            display: flex;
            user-select: none;
            justify-content: center;
            background: none;
        }

        .main-box {
            margin: auto;
            color: rgba(89, 0, 255, 0.371);
            font-weight: bold;
            font-family: sans-serif;
            display: flex;
            flex-flow: column;
            background: rgba(106, 0, 255, 0.381);
            align-items: center;
            padding: 50px;
        }

        label {
            color: rgba(255, 255, 255, 0.614)
        }
        
    </style>
</head>
<body>
    <div class="main-box">
        <h2>Veículo sincronizado:</h2>
        <h3 class="modelinfo"> loading... </h3>
        <label class="m-1"">Suspensão</label>
    <div>
        <input hidden type="number" placeholder="ex: Top dos tops" class="susp form-control"/>
        <button class="add btn btn-success">+</button>
        <button class="sub btn btn-danger">-</button>
    </div>
        <label class="m-1"">Farol</label>
    <div id="headLightsDiv">
        <button id="lightOn" class="btn btn-success">ON</button>
        <button id="lightOff" class="btn btn-danger">OFF</button>
    </div>
        <label id="neonLabel" class="m-1"">Neon</label>
    <div id="neonLightsDiv">
        <button id="neonOn" class="btn btn-success">ON</button>
        <button id="neonOff" class="btn btn-danger">OFF</button>
    </div>
    <div class="m-3">
        <button class="closeSusp btn btn-danger">Fechar</button>
    </div>
    </div>
</body>
<script>
    $(() => {

        $("body").hide()
        window.addEventListener("message", function(event){
            if (event.data.show != undefined) {
                let status = event.data.show
                if (status) {
                    $("body").show()
                    $(".susp").val(event.data.suspValue.toFixed(2))
                    $(".modelinfo").text(`${event.data.vehicleName == "NULL" ? "Not found" : event.data.vehicleName} - ${event.data.vehiclePlate}`)
                    console.log(event.data.vehicleNeon)
                    if (!event.data.vehicleNeon) {
                        $("#neonLightsDiv").text("Esse veículo não possui neon")
                        $("#neonLightsDiv").hide()
                
                    } else {
                        $("#neonLightsDiv").text("Neon")
                        $("#neonLightsDiv").show()
                    }
                } else {
                    $("body").hide()
                }
            }
        })
        $(".closeSusp").click(function() {
            $.post("https://SuspensionChange/closeSusp")
        })
        $("#lightOn").click(function() {
            $.post("https://SuspensionChange/setLightsOn")
        })
        $("#lightOff").click(function() {
            $.post("https://SuspensionChange/setLightsOff")
        })
        $("#neonOn").click(function() {
            $.post("https://SuspensionChange/setNeonOn")
        })
        $("#neonOff").click(function() {
            $.post("https://SuspensionChange/setNeonOff")
        })
        $(".add").click(function() {
            const suspAmount = Number($(".susp").val());
            console.log(suspAmount)
            if (suspAmount <= 0.17 && suspAmount >= -0.05) {
                $(".susp").val((suspAmount - 0.01).toFixed(2))
                $.post("http://SuspensionChange/showSusp", JSON.stringify({ susp: Number($(".susp").val()) }))
            }
        })
        $(".sub").click(function() {
            const suspAmount = Number($(".susp").val());
            if (suspAmount <= 0.16) {
                $(".susp").val((suspAmount + 0.01).toFixed(2))
                $.post("http://SuspensionChange/showSusp", JSON.stringify({ susp: Number($(".susp").val()) }))
            }
        })
    })
</script>
</html>